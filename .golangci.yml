# golangci-lint configuration (v1.61.0)
# See CONTRIBUTING.md for rationale on each linter.

run:
  timeout: 5m
  modules-download-mode: readonly

linters:
  disable-all: true
  enable:
    # Core linters (non-negotiable per CONTRIBUTING.md)
    - errcheck      # Unchecked errors - critical for distributed systems
    - staticcheck   # Gold standard Go static analysis
    - govet         # Catches subtle issues
    - gosec         # Security vulnerabilities (ADR-013)
    - bodyclose     # HTTP response body leaks
    - noctx         # HTTP requests missing context (ADR-009)

    # Strongly recommended
    - errname       # Error type naming conventions
    - errorlint     # Proper errors.Is/As usage
    - exhaustive    # Exhaustive switch on enums
    - revive        # Configurable style enforcement
    - gocritic      # Opinionated but catches real bugs
    - misspell      # Typos
    - unconvert     # Unnecessary type conversions
    - unparam       # Unused function parameters

    # Complexity
    - gocyclo       # Cyclomatic complexity
    - gocognit      # Cognitive complexity

    # Formatting
    - gofmt
    - goimports

linters-settings:
  gocyclo:
    min-complexity: 16  # Per CONTRIBUTING.md; error mappers legitimately have 16 cases

  gocognit:
    min-complexity: 20  # Per CONTRIBUTING.md

  govet:
    enable-all: true
    disable:
      - fieldalignment  # Not critical for this project; causes noise

  revive:
    rules:
      - name: exported
        arguments:
          - checkPrivateReceivers
          - sayRepetitiveInsteadOfStutters
      - name: blank-imports
      - name: context-as-argument
      - name: context-keys-type
      - name: dot-imports
      - name: error-return
      - name: error-strings
      - name: error-naming
      - name: increment-decrement
      - name: var-naming
      - name: package-comments
      - name: range
      - name: receiver-naming
      - name: time-naming
      - name: unexported-return
      - name: indent-error-flow
      - name: errorf

  gosec:
    excludes:
      - G104  # Unhandled errors (covered by errcheck)

issues:
  exclude-rules:
    # Relax rules for test files
    - path: _test\.go
      linters:
        - gocyclo
        - errcheck
        - gosec
        - dupl
    # Exclude generated code
    - path: gen/
      linters:
        - errcheck
        - gosec
        - govet

output:
  formats:
    - format: colored-line-number
  print-issued-lines: true
  print-linter-name: true
  sort-results: true
